function l(n,o){console.time(n.name);let t=n(...o??[]);return console.timeEnd(n.name),t}async function d(n,o){console.time(n.name);let t=await n(...o??[]);return console.timeEnd(n.name),t}function m(){return new Promise((n,o)=>{let t=indexedDB.open("BibleQueryDB"),c=!1;t.onsuccess=async()=>{if(!c){let r=t.result,e=await f(r,"fin-33-38");n(e)}},t.onupgradeneeded=()=>{c=!0;let r=t.result;r.createObjectStore("fin-33-38",{autoIncrement:!0}).transaction.oncomplete=async()=>{let e=await d(h,["fin-33-38"]),s=t.result.transaction("fin-33-38","readwrite"),a=s.objectStore("fin-33-38");for(let i of e)a.add(i);s.oncomplete=()=>{n(e)},s.onerror=i=>{o(i)}}},t.onerror=r=>{o(r)}})}function f(n,o){return new Promise((t,c)=>{let r=n.transaction(o,"readonly"),e=r.objectStore(o).getAll(),s=[];r.oncomplete=()=>{t(s)},r.onerror=a=>{c(a)},e.onsuccess=()=>{s=e.result}})}async function h(n){let t=await(await fetch(`data/${n}.txt`)).text();return x(t)}function x(n){let o=n.split(`
`),t=[];o.pop();let c="",r="",e=1,s=1;for(let a of o)if(a.startsWith(";")){let[i,p,u]=a.split(";");c=p,r=u,e=1,s=1}else a.startsWith("+")?(e+=1,s=1):(t.push({id:c,book:r,chapter:e.toString(),verse:s.toString(),text:a}),s+=1);return t}function g(n){let o=document.querySelector("table");if(o===null)throw Error("Table not found!");let t="",c="";for(let r=0;r<n.length;r++){let e=n[r];if(e.book!==t||e.chapter!==c){let p=document.createElement("tr"),u=document.createElement("th");u.colSpan=2,u.innerText=`${e.book}, Luku ${e.chapter}`,u.role="rowheader",p.appendChild(u),o.appendChild(p),t=e.book,c=e.chapter}let s=document.createElement("tr"),a=document.createElement("td"),i=document.createElement("td");a.innerText=e.chapter+":"+e.verse,i.innerText=e.text,s.append(a,i),o.appendChild(s)}}var w=await d(m);l(g,[w]);export{x as customToJSON,m as fetchPassages,f as fetchPassagesFromIDB,h as fetchPassagesFromServer,d as timeAsync,l as timeSync};
